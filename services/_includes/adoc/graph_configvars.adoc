// set the attribute to true or leave empty, true without any quotes.

:show-deprecation: false

ifeval::[{show-deprecation} == true]

[[deprecation-note]]
[caption=]
.Deprecation notes for the graph service
[width="100%",cols="~,~,~,~",options="header"]
|===
| Deprecation Info
| Deprecation Version
| Removal Version
| Deprecation Replacment
|===

endif::[]

[caption=]
.Environment variables for the graph service
[width="100%",cols="~,~,~,~",options="header"]
|===
| Name
| Type
| Default Value
| Description

a|`OCIS_TRACING_ENABLED` +
`GRAPH_TRACING_ENABLED` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Activates tracing.

a|`OCIS_TRACING_TYPE` +
`GRAPH_TRACING_TYPE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The type of tracing. Defaults to "", which is the same as "jaeger". Allowed tracing types are "jaeger" and "" as of now.

a|`OCIS_TRACING_ENDPOINT` +
`GRAPH_TRACING_ENDPOINT` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The endpoint of the tracing agent.

a|`OCIS_TRACING_COLLECTOR` +
`GRAPH_TRACING_COLLECTOR` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The HTTP endpoint for sending spans directly to a collector, i.e. \http://jaeger-collector:14268/api/traces. Only used if the tracing endpoint is unset.

a|`OCIS_LOG_LEVEL` +
`GRAPH_LOG_LEVEL` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The log level. Valid values are: "panic", "fatal", "error", "warn", "info", "debug", "trace".

a|`OCIS_LOG_PRETTY` +
`GRAPH_LOG_PRETTY` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Activates pretty log output.

a|`OCIS_LOG_COLOR` +
`GRAPH_LOG_COLOR` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Activates colorized log output.

a|`OCIS_LOG_FILE` +
`GRAPH_LOG_FILE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The path to the log file. Activates logging to this file if set.

a|`OCIS_CACHE_STORE_TYPE` +
`GRAPH_CACHE_STORE_TYPE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The type of the cache store. Valid options are "noop", "ocmem", "etcd" and "memory"

a|`OCIS_CACHE_STORE_ADDRESS` +
`GRAPH_CACHE_STORE_ADDRESS` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
A comma-separated list of addresses to connect to. Only valid if the above setting is set to "etcd"

a|`OCIS_CACHE_STORE_SIZE` +
`GRAPH_CACHE_STORE_SIZE` +

a| [subs=-attributes]
++int ++
a| [subs=-attributes]
++0 ++
a| [subs=-attributes]
Maximum number of items per table in the ocmem cache store. Other cache stores will ignore the option and can grow indefinitely.

a|`GRAPH_DEBUG_ADDR` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++127.0.0.1:9124 ++
a| [subs=-attributes]
Bind address of the debug server, where metrics, health, config and debug endpoints will be exposed.

a|`GRAPH_DEBUG_TOKEN` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
Token to secure the metrics endpoint.

a|`GRAPH_DEBUG_PPROF` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Enables pprof, which can be used for profiling.

a|`GRAPH_DEBUG_ZPAGES` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Enables zpages, which can be used for collecting and viewing in-memory traces.

a|`GRAPH_HTTP_ADDR` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++127.0.0.1:9120 ++
a| [subs=-attributes]
The bind address of the HTTP service.

a|`GRAPH_HTTP_ROOT` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++/graph ++
a| [subs=-attributes]
Subdirectory that serves as the root for this HTTP service.

a|`OCIS_HTTP_TLS_ENABLED` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Activates TLS for the http based services using the server certifcate and key configured via OCIS_HTTP_TLS_CERTIFICATE and OCIS_HTTP_TLS_KEY. If OCIS_HTTP_TLS_CERTIFICATE is not set a temporary server certificate is generated - to be used with PROXY_INSECURE_BACKEND=true.

a|`OCIS_HTTP_TLS_CERTIFICATE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
Path/File name of the TLS server certificate (in PEM format) for the http services.

a|`OCIS_HTTP_TLS_KEY` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
Path/File name for the TLS certificate key (in PEM format) for the server certificate to use for the http services.

a|`GRAPH_HTTP_API_TOKEN` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
An optional API bearer token

a|`GRAPH_GROUP_MEMBERS_PATCH_LIMIT` +

a| [subs=-attributes]
++int ++
a| [subs=-attributes]
++20 ++
a| [subs=-attributes]
The amount of group members allowed to be added with a single patch request.

a|`GRAPH_USERNAME_MATCH` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++default ++
a| [subs=-attributes]
Option to allow legacy usernames. Supported options are 'default' and 'none'.

a|`REVA_GATEWAY` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++127.0.0.1:9142 ++
a| [subs=-attributes]
The CS3 gateway endpoint.

a|`OCIS_GRPC_CLIENT_TLS_MODE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
TLS mode for grpc connection to the go-micro based grpc services. Possible values are 'off', 'insecure' and 'on'. 'off': disables transport security for the clients. 'insecure' allows to use transport security, but disables certificate verification (to be used with the autogenerated self-signed certificates). 'on' enables transport security, including server ceritificate verification.

a|`OCIS_GRPC_CLIENT_TLS_CACERT` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
Path/File name for the root CA certificate (in PEM format) used to validate TLS server certificates of the go-micro based grpc services.

a|`OCIS_JWT_SECRET` +
`GRAPH_JWT_SECRET` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The secret to mint and validate jwt tokens.

a|`OCIS_GRPC_CLIENT_TLS_MODE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
TLS mode for grpc connection to the go-micro based grpc services. Possible values are 'off', 'insecure' and 'on'. 'off': disables transport security for the clients. 'insecure' allows to use transport security, but disables certificate verification (to be used with the autogenerated self-signed certificates). 'on' enables transport security, including server ceritificate verification.

a|`OCIS_GRPC_CLIENT_TLS_CACERT` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
Path/File name for the root CA certificate (in PEM format) used to validate TLS server certificates of the go-micro based grpc services.

a|`GRAPH_APPLICATION_ID` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The ocis application id shown in the graph. All app roles are tied to this.

a|`GRAPH_APPLICATION_DISPLAYNAME` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ownCloud Infinite Scale ++
a| [subs=-attributes]
The oCIS application name

a|`OCIS_URL` +
`GRAPH_SPACES_WEBDAV_BASE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++https://localhost:9200 ++
a| [subs=-attributes]
The public facing URL of WebDAV.

a|`GRAPH_SPACES_WEBDAV_PATH` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++/dav/spaces/ ++
a| [subs=-attributes]
The WebDAV subpath for spaces.

a|`GRAPH_SPACES_DEFAULT_QUOTA` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++1000000000 ++
a| [subs=-attributes]
The default quota in bytes.

a|`GRAPH_SPACES_EXTENDED_SPACE_PROPERTIES_CACHE_TTL` +

a| [subs=-attributes]
++int ++
a| [subs=-attributes]
++0 ++
a| [subs=-attributes]
Max TTL in seconds for the spaces property cache.

a|`GRAPH_SPACES_USERS_CACHE_TTL` +

a| [subs=-attributes]
++int ++
a| [subs=-attributes]
++1800000000000 ++
a| [subs=-attributes]
Max TTL in seconds for the spaces users cache.

a|`GRAPH_SPACES_GROUPS_CACHE_TTL` +

a| [subs=-attributes]
++int ++
a| [subs=-attributes]
++1800000000000 ++
a| [subs=-attributes]
Max TTL in seconds for the spaces groups cache.

a|`GRAPH_IDENTITY_BACKEND` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ldap ++
a| [subs=-attributes]
The user identity backend to use. Supported backend types are 'ldap' and 'cs3'.

a|`LDAP_URI` +
`GRAPH_LDAP_URI` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ldaps://localhost:9235 ++
a| [subs=-attributes]
URI of the LDAP Server to connect to. Supported URI schemes are 'ldaps://' and 'ldap://'

a|`LDAP_CACERT` +
`GRAPH_LDAP_CACERT` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++~/.ocis/idm/ldap.crt ++
a| [subs=-attributes]
Path/File name for the root CA certificate (in PEM format) used to validate TLS server certificates of the LDAP service.

a|`LDAP_INSECURE` +
`GRAPH_LDAP_INSECURE` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Disable TLS certificate validation for the LDAP connections. Do not set this in production environments.

a|`LDAP_BIND_DN` +
`GRAPH_LDAP_BIND_DN` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++uid=libregraph,ou=sysusers,o=libregraph-idm ++
a| [subs=-attributes]
LDAP DN to use for simple bind authentication with the target LDAP server.

a|`LDAP_BIND_PASSWORD` +
`GRAPH_LDAP_BIND_PASSWORD` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
Password to use for authenticating the 'bind_dn'.

a|`GRAPH_LDAP_SERVER_UUID` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
If set to true, rely on the LDAP Server to generate a unique ID for users and groups, like when using 'entryUUID' as the user ID attribute.

a|`GRAPH_LDAP_SERVER_USE_PASSWORD_MODIFY_EXOP` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++true ++
a| [subs=-attributes]
User the Password Modify Extended Operation for updating user passwords.

a|`GRAPH_LDAP_SERVER_WRITE_ENABLED` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++true ++
a| [subs=-attributes]
Allow to create, modify and delete LDAP users via GRAPH API. This is only works when the default Schema is used.

a|`LDAP_USER_BASE_DN` +
`GRAPH_LDAP_USER_BASE_DN` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ou=users,o=libregraph-idm ++
a| [subs=-attributes]
Search base DN for looking up LDAP users.

a|`LDAP_USER_SCOPE` +
`GRAPH_LDAP_USER_SCOPE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++sub ++
a| [subs=-attributes]
LDAP search scope to use when looking up users. Supported scopes are 'base', 'one' and 'sub'.

a|`LDAP_USER_FILTER` +
`GRAPH_LDAP_USER_FILTER` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
LDAP filter to add to the default filters for user search like '(objectclass=ownCloud)'.

a|`LDAP_USER_OBJECTCLASS` +
`GRAPH_LDAP_USER_OBJECTCLASS` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++inetOrgPerson ++
a| [subs=-attributes]
The object class to use for users in the default user search filter ('inetOrgPerson').

a|`LDAP_USER_SCHEMA_MAIL` +
`GRAPH_LDAP_USER_EMAIL_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++mail ++
a| [subs=-attributes]
LDAP Attribute to use for the email address of users.

a|`LDAP_USER_SCHEMA_DISPLAY_NAME` +
`GRAPH_LDAP_USER_DISPLAYNAME_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++displayName ++
a| [subs=-attributes]
LDAP Attribute to use for the displayname of users.

a|`LDAP_USER_SCHEMA_USERNAME` +
`GRAPH_LDAP_USER_NAME_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++uid ++
a| [subs=-attributes]
LDAP Attribute to use for username of users.

a|`LDAP_USER_SCHEMA_ID` +
`GRAPH_LDAP_USER_UID_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++owncloudUUID ++
a| [subs=-attributes]
LDAP Attribute to use as the unique ID for users. This should be a stable globally unique ID like a UUID.

a|`LDAP_GROUP_BASE_DN` +
`GRAPH_LDAP_GROUP_BASE_DN` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ou=groups,o=libregraph-idm ++
a| [subs=-attributes]
Search base DN for looking up LDAP groups.

a|`LDAP_GROUP_SCOPE` +
`GRAPH_LDAP_GROUP_SEARCH_SCOPE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++sub ++
a| [subs=-attributes]
LDAP search scope to use when looking up groups. Supported scopes are 'base', 'one' and 'sub'.

a|`LDAP_GROUP_FILTER` +
`GRAPH_LDAP_GROUP_FILTER` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
LDAP filter to add to the default filters for group searches.

a|`LDAP_GROUP_OBJECTCLASS` +
`GRAPH_LDAP_GROUP_OBJECTCLASS` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++groupOfNames ++
a| [subs=-attributes]
The object class to use for groups in the default group search filter ('groupOfNames'). 

a|`LDAP_GROUP_SCHEMA_GROUPNAME` +
`GRAPH_LDAP_GROUP_NAME_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++cn ++
a| [subs=-attributes]
LDAP Attribute to use for the name of groups.

a|`LDAP_GROUP_SCHEMA_ID` +
`GRAPH_LDAP_GROUP_ID_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++owncloudUUID ++
a| [subs=-attributes]
LDAP Attribute to use as the unique id for groups. This should be a stable globally unique ID like a UUID.

a|`LDAP_EDUCATION_RESOURCES_ENABLED` +
`GRAPH_LDAP_EDUCATION_RESOURCES_ENABLED` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Enable LDAP support for managing education related resources

a|`LDAP_SCHOOL_BASE_DN` +
`GRAPH_LDAP_SCHOOL_BASE_DN` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
Search base DN for looking up LDAP schools.

a|`LDAP_SCHOOL_SCOPE` +
`GRAPH_LDAP_SCHOOL_SEARCH_SCOPE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
LDAP search scope to use when looking up schools. Supported scopes are 'base', 'one' and 'sub'.

a|`LDAP_SCHOOL_FILTER` +
`GRAPH_LDAP_SCHOOL_FILTER` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
LDAP filter to add to the default filters for school searches.

a|`LDAP_SCHOOL_OBJECTCLASS` +
`GRAPH_LDAP_SCHOOL_OBJECTCLASS` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The object class to use for schools in the default school search filter.

a|`LDAP_SCHOOL_SCHEMA_SCHOOL_NAME` +
`GRAPH_LDAP_SCHOOL_NAME_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
LDAP Attribute to use for the name of a school.

a|`LDAP_SCHOOL_SCHEMA_SCHOOL_NUMBER` +
`GRAPH_LDAP_SCHOOL_NUMBER_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
LDAP Attribute to use for the number of a school.

a|`LDAP_SCHOOL_SCHEMA_ID` +
`GRAPH_LDAP_SCHOOL_ID_ATTRIBUTE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
LDAP Attribute to use as the unique id for schools. This should be a stable globally unique ID like a UUID.

a|`GRAPH_EVENTS_ENDPOINT` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++127.0.0.1:9233 ++
a| [subs=-attributes]
The address of the event system. The event system is the message queuing service. It is used as message broker for the microservice architecture. Set to a empty string to disable emitting events.

a|`GRAPH_EVENTS_CLUSTER` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ocis-cluster ++
a| [subs=-attributes]
The clusterID of the event system. The event system is the message queuing service. It is used as message broker for the microservice architecture.

a|`OCIS_INSECURE` +
`GRAPH_EVENTS_TLS_INSECURE` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Whether to verify the server TLS certificates.

a|`GRAPH_EVENTS_TLS_ROOT_CA_CERTIFICATE` +

a| [subs=-attributes]
++string ++
a| [subs=-attributes]
++ ++
a| [subs=-attributes]
The root CA certificate used to validate the server's TLS certificate. If provided GRAPH_EVENTS_TLS_INSECURE will be seen as false.

a|`OCIS_EVENTS_ENABLE_TLS` +
`GRAPH_EVENTS_ENABLE_TLS` +

a| [subs=-attributes]
++bool ++
a| [subs=-attributes]
++false ++
a| [subs=-attributes]
Enable TLS for the connection to the events broker. The events broker is the ocis service which receives and delivers events between the services..
|===

